<robot name="drone_ea">

  <!-- ============  Materials  ============ -->
  <material name="grey"><color rgba="0.7 0.7 0.7 1"/></material>
  <material name="red"><color rgba="0.7 0 0 1"/></material>
  <material name="black"><color rgba="0.2 0.2 0.2 1"/></material>

  <!-- ============  Root  ============ -->
  <link name="root_link">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0"/>
      <inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/>
    </inertial>
  </link>

  <!-- ============  Fuselage  ============ -->
  <joint name="fixed_joint_base_fuselage" type="fixed">
    <parent link="root_link"/>
    <child  link="fuselage"/>
    <origin xyz="0 0 0" rpy="3.141592653589793 0 0"/>
  </joint>

  <link name="fuselage">
    <inertial>
      <origin xyz="-0.275 0 -0.04" rpy="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="2.9015955e-04" ixy="0" ixz="0"
              iyy="7.4080147e-03" iyz="0"
              izz="7.4511885e-03"/>
    </inertial>

    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://meshes/fuselage_only.stl" scale="0.00097 0.001 0.001"/>
      </geometry>
      <material name="grey"/>
    </visual>

    <!-- *** UNICA collisione del modello *** -->
    <collision>
      <!-- centro del fusolage a –0.35 m dall’origine del link -->
      <origin xyz="-0.4 0 0" rpy="0 0 0"/>
      <geometry><box size="0.80 0.10 0.10"/></geometry>
    </collision>

  </link>

  <joint name="fixed_joint_aero_frame_fuselage" type="fixed">
    <parent link="fuselage"/>
    <child  link="aero_frame_fuselage"/>
    <origin xyz="-0.275 0 -0.03" rpy="0 3.141592653589793 0"/>
  </joint>

  <link name="aero_frame_fuselage">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0"/>
      <inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/>
    </inertial>
  </link>

  <!-- ============  Elevator  ============ -->
  <joint name="elevator_pitch_joint" type="revolute">
    <parent link="fuselage"/>
    <child  link="elevator"/>
    <origin xyz="-0.75 0 -0.0" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit lower="-0.261799" upper="0.261799" effort="5" velocity="2"/>
    <dynamics damping="1" friction="0"/>
  </joint>

  <link name="elevator">
    <inertial>
      <origin xyz="-0.0434 0 0" rpy="0 0 0"/>
      <mass value="0.05"/>
      <inertia ixx="2.083333e-04" ixy="0" ixz="0" iyy="7.083333e-04" iyz="0" izz="8.333333e-04"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><mesh filename="package://meshes/elevator.stl" scale="0.0007 0.0012 0.001"/></geometry>
      <material name="grey"/>
    </visual>
    <collision>
      <!-- il bordo di attacco dell’elevator coincide con l’origine del link
          (hinge line) → centro a –0.055 m -->
      <origin xyz="-0.1 0 0" rpy="0 0 0"/>
      <!-- chord = 0.11 thickness = 0.02 span = 0.30 -->
      <geometry><box size="0.2 0.3 0.05"/></geometry>
    </collision>
  </link>

  <!-- nuovo frame aerodinamico elevator -->
  <joint name="fixed_joint_aero_frame_elevator" type="fixed">
    <parent link="elevator"/>
    <child  link="aero_frame_elevator"/>
    <!-- COM elevator è all'origine del link -->
    <origin xyz="-0.0434 0 0" rpy="0 3.141592653589793 0"/>
  </joint>

  <link name="aero_frame_elevator">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <!-- ============  Rudder  ============ -->
  <joint name="rudder_yaw_joint" type="revolute">
    <parent link="elevator"/>
    <child  link="rudder"/>
    <origin xyz="-0.0 0 0" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-0.523599" upper="0.523599" effort="3" velocity="2.5"/>
    <dynamics damping="1" friction="0"/>
  </joint>

  <link name="rudder">
    <inertial>
      <origin xyz="-0.0372 0 -0.08" rpy="0 0 0"/>
      <mass value="0.02"/>
      <inertia ixx="5.283333e-05" ixy="0" ixz="0" iyy="7.083333e-05" iyz="0" izz="1.950000e-05"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><mesh filename="package://meshes/rudder.stl" scale="0.0008 0.001 0.001"/></geometry>
      <material name="red"/>
    </visual>
    <collision>
      <!-- centro geometrico in (-0.031, 0, -0.10) -->
      <origin xyz="-0.07 0 -0.8" rpy="0 0 0"/>
      <!-- chord = 0.062 thickness = 0.02 span = 0.20 -->
      <geometry><box size="0.15 0.05 0.15"/></geometry>
    </collision>
  </link>

  <!-- nuovo frame aerodinamico rudder -->
  <joint name="fixed_joint_aero_frame_rudder" type="fixed">
    <parent link="rudder"/>
    <child  link="aero_frame_rudder"/>
    <origin xyz="-0.0372 0 -0.08" rpy="0 3.141592653589793 0"/>
  </joint>

  <link name="aero_frame_rudder">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <!-- ========================================================= -->
  <!--                      Right wing chain                     -->
  <!-- ========================================================= -->
  <joint name="fixed_joint_right_wing" type="fixed">
    <parent link="fuselage"/>
    <child  link="fuselage_right_0"/>
    <origin xyz="-0.275 0.05 -0.03"
            rpy="0 0 3.141592653589793"/>
  </joint>

  <link name="fuselage_right_0">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.1"/>
      <!-- Box 0.20 × 0.10 × 0.05 m -->
      <inertia ixx="5.651e-05" ixy="0" ixz="0"
               iyy="5.651e-05" iyz="0"
               izz="5.651e-05"/>
    </inertial>
  </link>

  <joint name="joint_0_twist_right_wing" type="revolute">
    <parent link="fuselage_right_0"/>
    <child  link="fuselage_right_1"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
    <limit effort="5" lower="-0.5235987756" upper="0.5235987756" velocity="3.665191429"/>
    <dynamics damping="1" friction="0"/>
  </joint>

  <link name="fuselage_right_1">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <joint name="joint_1_fixed_right_wing" type="fixed">
    <parent link="fuselage_right_1"/>
    <child  link="fuselage_right_2"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="fuselage_right_2">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <joint name="joint_2_fixed_right_wing" type="fixed">
    <parent link="fuselage_right_2"/>
    <child  link="right_wing"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="right_wing">
    <inertial>
      <origin xyz="0.034436664 -0.35 0" rpy="0 0 0"/>
      <mass value="0.059258"/>
      <!-- CAD based (kept from original, already consistente) -->
      <inertia ixx="3.161532e-03" ixy="0" ixz="0"
               iyy="1.312526e-04" iyz="0"
               izz="3.290610e-03"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://meshes/wing0009.stl" scale="0.2 0.7 0.2"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <!-- centro a ( +0.034 , –0.40 , 0 ) come il COM CAD -->
      <origin xyz="0.034  -0.40  0.0" rpy="0 0 0"/>
      <!-- chord = 0.20 thickness = 0.02 half-span = 0.80  ⇒  span = 1.60 -->
      <geometry><box size="0.20 0.8 0.05"/></geometry>
    </collision>
  </link>

  <joint name="fixed_joint_aero_frame_right_wing" type="fixed">
    <parent link="right_wing"/>
    <child  link="aero_frame_right_wing"/>
    <origin xyz="0.034436664 -0.35 0" rpy="3.141592653589793 0 0"/>
  </joint>

  <link name="aero_frame_right_wing">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <!-- ========================================================= -->
  <!--                      Left wing chain                      -->
  <!-- ========================================================= -->
  <joint name="fixed_joint_left_wing" type="fixed">
    <parent link="fuselage"/>
    <child  link="fuselage_left_0"/>
    <origin xyz="-0.275 -0.05 -0.03"
            rpy="0 3.141592653589793 0"/>
  </joint>

  <link name="fuselage_left_0">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="5.651e-05" ixy="0" ixz="0"
               iyy="5.651e-05" iyz="0"
               izz="5.651e-05"/>
    </inertial>

  </link>

  <joint name="joint_0_twist_left_wing" type="revolute">
    <parent link="fuselage_left_0"/>
    <child  link="fuselage_left_1"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <axis xyz="0 -1 0"/>
    <limit effort="5" lower="-0.5235987756" upper="0.5235987756" velocity="3.665191429"/>
    <dynamics damping="1" friction="0"/>
  </joint>

  <link name="fuselage_left_1">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <joint name="joint_1_fixed_left_wing" type="fixed">
    <parent link="fuselage_left_1"/>
    <child  link="fuselage_left_2"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="fuselage_left_2">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <joint name="joint_2_fixed_left_wing" type="fixed">
    <parent link="fuselage_left_2"/>
    <child  link="left_wing"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="left_wing">
    <inertial>
      <origin xyz="0.034436664 -0.35 0" rpy="0 0 0"/>
      <mass value="0.059258"/>
      <inertia ixx="3.161532e-03" ixy="0" ixz="0"
               iyy="1.312526e-04" iyz="0"
               izz="3.290610e-03"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <mesh filename="package://meshes/wing0009.stl" scale="0.2 0.7 0.2"/>
      </geometry>
      <material name="red"/>
    </visual>
    <collision>
      <origin xyz="0.034  -0.40  0.0" rpy="0 0 0"/>
      <geometry><box size="0.20 0.8 0.05"/></geometry>
    </collision>
  </link>

  <joint name="fixed_joint_aero_frame_left_wing" type="fixed">
    <parent link="left_wing"/>
    <child  link="aero_frame_left_wing"/>
    <origin xyz="0.034436664 -0.35 0" rpy="0 0 0"/>
  </joint>

  <link name="aero_frame_left_wing">
    <inertial><origin xyz="0 0 0" rpy="0 0 0"/><mass value="0"/><inertia ixx="0" ixy="0" ixz="0" iyy="0" iyz="0" izz="0"/></inertial>
  </link>

  <!-- ========================================================= -->
  <!--                       Prop frame                          -->
  <!-- ========================================================= -->
  <joint name="fixed_joint_prop_frame_fuselage_0" type="fixed">
    <parent link="fuselage"/>
    <child  link="prop_frame_fuselage_0"/>
    <origin xyz="0 0 0" rpy="3.141592653589793 -1.5707963267948966 0"/>
  </joint>

  <link name="prop_frame_fuselage_0">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <mass value="0.031"/>
      <!-- slender cylinder r = 0.005, L irrelevant for spin axis -->
      <inertia ixx="3.7625e-05" ixy="0" ixz="0"
               iyy="3.7625e-05" iyz="0"
               izz="7.5000e-05"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><cylinder radius="0.005" length="0.005"/></geometry>
      <material name="black"/>
    </visual>
    <!-- niente collision qui -->
  </link>

</robot>
